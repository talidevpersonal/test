import React, { useState } from "react";
import {
  Button,
  Menu,
  MenuItem,
  Select,
  FormControl,
  InputLabel,
} from "@mui/material";

function CustomCalendarMenu() {
  const [anchorEl, setAnchorEl] = useState(null);
  const [selectionType, setSelectionType] = useState("months");
  const [selectedValue, setSelectedValue] = useState("");
  const open = Boolean(anchorEl);

  const months = [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December",
  ];

  const quarters = ["Q1 (Jan - Mar)", "Q2 (Apr - Jun)", "Q3 (Jul - Sep)", "Q4 (Oct - Dec)"];
  const years = Array.from({ length: 10 }, (_, i) => new Date().getFullYear() - i);

  const handleMenuOpen = (event) => {
    setAnchorEl(event.currentTarget);
  };

  const handleMenuClose = () => {
    setAnchorEl(null);
  };

  const handleSelectionTypeChange = (event) => {
    setSelectionType(event.target.value);
    setSelectedValue("");
  };

  const handleValueChange = (value) => {
    setSelectedValue(value);
    setAnchorEl(null); // Close the menu after selection
  };

  return (
    <div>
      {/* Button to open menu */}
      <Button variant="contained" onClick={handleMenuOpen}>
        {selectedValue || "Select Date Range"}
      </Button>

      {/* Menu Component */}
      <Menu
        anchorEl={anchorEl}
        open={open}
        onClose={handleMenuClose}
        MenuListProps={{
          "aria-labelledby": "calendar-menu-button",
        }}
      >
        {/* Dropdown to select Months, Quarters, or Years */}
        <MenuItem>
          <FormControl fullWidth>
            <InputLabel id="selection-type-label">View By</InputLabel>
            <Select
              labelId="selection-type-label"
              value={selectionType}
              onChange={handleSelectionTypeChange}
            >
              <MenuItem value="months">Months</MenuItem>
              <MenuItem value="quarters">Quarters</MenuItem>
              <MenuItem value="years">Years</MenuItem>
            </Select>
          </FormControl>
        </MenuItem>

        {/* Options based on selection type */}
        {selectionType === "months" &&
          months.map((month) => (
            <MenuItem key={month} onClick={() => handleValueChange(month)}>
              {month}
            </MenuItem>
          ))}

        {selectionType === "quarters" &&
          quarters.map((quarter) => (
            <MenuItem key={quarter} onClick={() => handleValueChange(quarter)}>
              {quarter}
            </MenuItem>
          ))}

        {selectionType === "years" &&
          years.map((year) => (
            <MenuItem key={year} onClick={() => handleValueChange(year)}>
              {year}
            </MenuItem>
          ))}
      </Menu>
    </div>
  );
}

export default CustomCalendarMenu;
